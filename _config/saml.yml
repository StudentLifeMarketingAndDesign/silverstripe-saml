---
Name: samlsettings
After: '#rootroutes'
---
SilverStripe\Control\Director:
  rules:
    'saml': SilverStripe\SAML\Control\SAMLController

SilverStripe\Security\Member:
  extensions:
    - SilverStripe\SAML\Extensions\SAMLMemberExtension
    - SilverStripe\SAML\Extensions\ActiveDirectoryMemberExtension
  claims_field_mappings:
    'urn:oid:2.5.4.42' : 'FirstName'
    'urn:oid:2.5.4.4' : 'Surname'
    'urn:oid:0.9.2342.19200300.100.1.3' : 'Email'
    'silverstripeRoles' : 'silverstripeRoles'
    
SilverStripe\Core\Injector\Injector:
  SAMLConfService: SilverStripe\SAML\Services\SAMLConfiguration

SilverStripe\SAML\Authenticators\SAMLAuthenticator:
  name: "HawkID Login"
  
---
Except:
  environment: 'live'
---
SilverStripe\SAML\Services\SAMLConfiguration:
  strict: true
  debug: true
  SP:
    entityId: "https://md.studentlife.uiowa.edu/sp-test"
    privateKey: "/local/www/certs/saml.pem"
    x509cert: "/local/www/certs/saml.crt"
    nameIdFormat: "urn:oid:1.2.840.113556.1.4.2"
  IdP:
    entityId: "iowafed-test:idp:uiowa.edu"
    x509cert: "/local/www/certs/idp-test.uiowa.edu.SAMLsigning_8443.cert"
    singleSignOnService: "https://idp-test.uiowa.edu/idp/profile/SAML2/Redirect/SSO"

  debug: false
  expect_binary_nameid: true
  allow_insecure_email_linking: false
  Security:
    signatureAlgorithm: "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"
---
Only:
  environment: 'live'
---
SilverStripe\SAML\Services\SAMLConfiguration:
  strict: true
  debug: true
  SP:
    entityId: "https://md.studentlife.uiowa.edu/sp"
    privateKey: "/local/www/certs/saml.pem"
    x509cert: "/local/www/certs/saml.crt"
    nameIdFormat: "urn:oid:1.2.840.113556.1.4.2"
  IdP:
    entityId: "urn:mace:incommon:uiowa.edu"
    x509cert: "/local/www/certs/uiowa_idp_prod_public_cert.pem"
    singleSignOnService: "https://idp.uiowa.edu/idp/profile/SAML2/Redirect/SSO"
  Security:
    signatureAlgorithm: "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"